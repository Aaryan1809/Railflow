<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Railway Flow Optimization Dashboard</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-shell">
        <div class="main-area">
            <!-- Header -->
            <div class="top-bar">
                <div class="top-left">
                    <div class="brand-row">
                        <div class="brand-pill">RF</div>
                        <div>
                            <div class="section-name" id="current-section">
                                RailFlow AI · Nadiad – Anand Section
                            </div>
                            <div class="subheading">
                                <span class="badge">
                                    <span class="badge-dot"></span>
                                    Real-time decision support
                                </span>
                                <span class="badge">
                                    Section controller view
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="datetime" id="datetime-display">Loading date and time...</div>
                </div>
                <div class="top-bar-actions">
                    <button id="ai-simulate-btn">
                        <span>AI-Driven Simulation</span>
                    </button>
                    <button id="reset-data-btn" class="secondary">
                        Reset Scenario
                    </button>
                </div>
            </div>

            <!-- Section Overview (static strip instead of jittery visualizer) -->
            <div class="section-overview">
                <div class="section-line">
                    <div class="section-node active">
                        <div class="section-dot"></div>
                        <span class="section-label">Nadiad</span>
                    </div>
                    <div class="section-connector"></div>
                    <div class="section-node">
                        <div class="section-dot"></div>
                        <span class="section-label">Kanjari</span>
                    </div>
                    <div class="section-connector"></div>
                    <div class="section-node">
                        <div class="section-dot"></div>
                        <span class="section-label">Uttarsanda</span>
                    </div>
                    <div class="section-connector"></div>
                    <div class="section-node">
                        <div class="section-dot"></div>
                        <span class="section-label">Ode</span>
                    </div>
                    <div class="section-connector"></div>
                    <div class="section-node">
                        <div class="section-dot"></div>
                        <span class="section-label">Anand</span>
                    </div>
                </div>
                <div class="section-overview-metrics">
                    <div class="section-pill">
                        <span id="overview-active-trains">12</span> active trains
                    </div>
                    <div class="section-pill">
                        <span id="overview-conflicts">0</span> conflicts
                    </div>
                    <div class="section-pill">
                        Mode: <span id="overview-mode">Simulation</span>
                    </div>
                </div>
            </div>

            <!-- Hero: AI Recommendations (full-width) -->
            <div class="panel panel-hero">
                <div class="panel-title-row">
                    <div>
                        <h3 class="panel-title">AI Optimization Recommendations</h3>
                        <div class="panel-subtitle">
                            Top actions for precedence, crossings, and holds
                        </div>
                    </div>
                    <div class="hero-summary">
                        <div class="hero-summary-item">
                            <span class="hero-label">Conflicts</span>
                            <span class="hero-value" id="hero-conflicts">0</span>
                        </div>
                        <div class="hero-summary-item">
                            <span class="hero-label">Avg Delay</span>
                            <span class="hero-value" id="hero-delay">0.0 min</span>
                        </div>
                        <div class="hero-summary-item">
                            <span class="hero-label">On-Time</span>
                            <span class="hero-value" id="hero-punctuality">0%</span>
                        </div>
                    </div>
                </div>
                <div id="recommendations-container" class="hero-recommendations">
                    <p>Loading AI analysis...</p>
                </div>
            </div>

            <!-- Row 1: KPIs + Priority (left) | Roster (right) -->
            <div class="layout-row">
                <div class="layout-col layout-col-2">
                    <!-- KPIs -->
                    <div class="panel panel-kpi">
                        <div class="panel-title-row">
                            <div>
                                <h3 class="panel-title">Key Performance Indicators</h3>
                                <div class="panel-subtitle">Section snapshot</div>
                            </div>
                        </div>
                        <div class="kpi-grid">
                            <div class="kpi-card">
                                <div class="kpi-header-row">
                                    <div class="kpi-label">Trains / hour</div>
                                </div>
                                <div class="kpi-main">
                                    <div class="kpi-value" id="kpi-throughput">0</div>
                                </div>
                                <div class="kpi-bar">
                                    <div class="kpi-bar-fill" id="kpi-throughput-bar"></div>
                                </div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-header-row">
                                    <div class="kpi-label">Avg delay (min)</div>
                                </div>
                                <div class="kpi-main">
                                    <div class="kpi-value" id="kpi-delay">0.0</div>
                                </div>
                                <div class="kpi-bar">
                                    <div class="kpi-bar-fill" id="kpi-delay-bar"></div>
                                </div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-header-row">
                                    <div class="kpi-label">Track utilization</div>
                                </div>
                                <div class="kpi-main">
                                    <div class="kpi-value" id="kpi-utilization">0%</div>
                                </div>
                                <div class="kpi-bar">
                                    <div class="kpi-bar-fill" id="kpi-utilization-bar"></div>
                                </div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-header-row">
                                    <div class="kpi-label">Conflicts</div>
                                </div>
                                <div class="kpi-main">
                                    <div class="kpi-value" id="kpi-conflicts">0</div>
                                </div>
                                <div class="kpi-bar">
                                    <div class="kpi-bar-fill" id="kpi-conflicts-bar"></div>
                                </div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-header-row">
                                    <div class="kpi-label">On-time (≤ 5 min)</div>
                                </div>
                                <div class="kpi-main">
                                    <div class="kpi-value" id="kpi-punctuality">0%</div>
                                </div>
                                <div class="kpi-bar">
                                    <div class="kpi-bar-fill" id="kpi-punctuality-bar"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Priority Rule Editor -->
                    <div class="panel">
                        <div class="panel-title-row">
                            <div>
                                <h3 class="panel-title">Priority Rules</h3>
                                <div class="panel-subtitle">Tune AI decision weights</div>
                            </div>
                        </div>
                        <div id="priority-editor">
                            <div class="rule-row">
                                <div class="rule-label-group">
                                    <span class="rule-label">Express weight</span>
                                    <span class="rule-value" id="rule-express-value">3</span>
                                </div>
                                <input type="range" id="rule-express" class="rule-input" min="1" max="5" step="1"
                                    value="3">
                            </div>
                            <div class="rule-row">
                                <div class="rule-label-group">
                                    <span class="rule-label">Passenger weight</span>
                                    <span class="rule-value" id="rule-passenger-value">2</span>
                                </div>
                                <input type="range" id="rule-passenger" class="rule-input" min="1" max="5" step="1"
                                    value="2">
                            </div>
                            <div class="rule-row">
                                <div class="rule-label-group">
                                    <span class="rule-label">Freight weight</span>
                                    <span class="rule-value" id="rule-freight-value">1</span>
                                </div>
                                <input type="range" id="rule-freight" class="rule-input" min="1" max="5" step="1"
                                    value="1">
                            </div>
                            <div class="rule-row">
                                <div class="rule-label-group">
                                    <span class="rule-label">Delay weight / min</span>
                                    <span class="rule-value" id="rule-delay-value">0.10</span>
                                </div>
                                <input type="range" id="rule-delay" class="rule-input" min="0" max="0.5" step="0.05"
                                    value="0.1">
                            </div>
                            <p class="rule-hint">
                                Higher weight ⇒ higher precedence when resolving conflicts.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Train Roster -->
                <div class="layout-col layout-col-2">
                    <div class="panel panel-roster">
                        <div class="panel-title-row">
                            <div>
                                <h3 class="panel-title">Train Roster</h3>
                                <div class="panel-subtitle">All trains in this section</div>
                            </div>
                        </div>
                        <div class="roster-controls">
                            <input type="text" id="train-search-input" class="roster-search"
                                placeholder="Search by train number or location...">
                            <div class="roster-filters">
                                <select id="filter-type" class="roster-select">
                                    <option value="all">Type: All</option>
                                    <option value="express">Express</option>
                                    <option value="passenger">Passenger</option>
                                    <option value="freight">Freight</option>
                                </select>
                                <select id="filter-direction" class="roster-select">
                                    <option value="all">Direction: All</option>
                                    <option value="up">Up (Nadiad → Anand)</option>
                                    <option value="down">Down (Anand → Nadiad)</option>
                                </select>
                                <select id="filter-status" class="roster-select">
                                    <option value="all">Status: All</option>
                                    <option value="running">Running</option>
                                    <option value="waiting">Waiting</option>
                                    <option value="halted">Halted</option>
                                    <option value="completed">Completed</option>
                                </select>
                            </div>
                        </div>
                        <div class="roster-table-wrapper">
                            <table class="roster-table">
                                <thead>
                                    <tr>
                                        <th data-sort="number">Train</th>
                                        <th data-sort="type">Type</th>
                                        <th data-sort="direction">Dir</th>
                                        <th data-sort="status">Status</th>
                                        <th data-sort="delayMinutes">Delay</th>
                                        <th data-sort="position">Location</th>
                                    </tr>
                                </thead>
                                <tbody id="train-roster-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Row 2: Log (left) | System + Scenarios (right) -->
            <div class="layout-row">
                <div class="layout-col layout-col-2">
                    <div class="panel">
                        <div class="panel-title-row">
                            <div>
                                <h3 class="panel-title">Event Log</h3>
                                <div class="panel-subtitle">AI + operator actions</div>
                            </div>
                        </div>
                        <div id="event-log-container" class="log-list"></div>
                    </div>
                </div>

                <div class="layout-col layout-col-2">
                    <div class="panel">
                        <div class="panel-title-row">
                            <div>
                                <h3 class="panel-title">System & Scenarios</h3>
                                <div class="panel-subtitle">Data feeds and quick what-if</div>
                            </div>
                        </div>
                        <div class="system-status-list">
                            <div class="system-status-item">
                                <span>Signalling</span>
                                <span class="status-pill status-simulated">Simulated</span>
                            </div>
                            <div class="system-status-item">
                                <span>TMS / Timetable</span>
                                <span class="status-pill status-simulated">Simulated</span>
                            </div>
                            <div class="system-status-item">
                                <span>Rolling Stock</span>
                                <span class="status-pill status-warning">Placeholder</span>
                            </div>
                            <div class="system-status-item">
                                <span>AI Engine</span>
                                <span class="status-pill status-ok">Online</span>
                            </div>
                        </div>

                        <div id="scenario-controls" class="scenario-block">
                            <div class="scenario-title">Quick Scenarios</div>
                            <div class="scenario-grid">
                                <button data-scenario="heavy-fog">Heavy fog (Up express)</button>
                                <button data-scenario="signal-failure-ode">Signal failure (Ode)</button>
                                <button data-scenario="maintenance-uttarsanda">Maintenance (Uttarsanda)</button>
                                <button data-scenario="clear-all">Clear all</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>
